<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script src="https://js.jotform.com/JotFormCustomWidget.min.js"></script>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 20px; }
        .pay-button { 
            background: #2e69ff; color: white; border: none; 
            padding: 12px 24px; border-radius: 4px; font-weight: bold; 
            cursor: pointer; font-size: 16px;
        }
        .pay-button:hover { background: #1a54e6; }
        #status { margin-top: 15px; color: #555; font-size: 14px; }
    </style>
</head>
<body>

    <div id="action-area">
        <button class="pay-button" onclick="launchTranzila()">Step 2: Add Credit Card Details</button>
        <div id="status">Click to verify your card via Tranzila secure portal.</div>
    </div>

    <script>
        function launchTranzila() {
            // This is the direct link to your terminal's payment page
            var tranzilaUrl = "https://direct.tranzila.com/toratshraga/iframenew.php?" + 
                             "sum=1&currency=1&tranmode=VK&contact=Student&nologo=1";
            
            // Open in a new tab/window to avoid Jotform script conflicts
            window.open(tranzilaUrl, "_blank");
            
            document.getElementById('status').innerText = "Please complete the card details in the new window.";
        }

        // Listen for the response (this part requires Step 2 below)
        window.addEventListener("message", function(event) {
            if (event.data && event.data.TranzilaTK) {
                JFCustomWidget.sendData({ value: event.data.TranzilaTK });
                document.getElementById('action-area').innerHTML = "<b>âœ… Card Successfully Linked</b>";
                JFCustomWidget.sendSubmit({ valid: true });
            }
        });
    </script>
</body>
</html>
